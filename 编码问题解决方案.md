# 编码问题解决方案

## 问题描述

在 Windows 系统上，由于默认使用 GBK/GB2312 编码，而项目文件使用 UTF-8 编码，导致中文字符显示为乱码。

## 已修复的问题

### 1. 文件编码统一
所有项目文件已转换为 **UTF-8 with BOM** 编码，包括：
- `locales/zh.ts` - 中文语言文件
- `locales/en.ts` - 英文语言文件
- `locales/ja.ts` - 日文语言文件
- `locales/ko.ts` - 韩文语言文件
- `测试方式说明.md` - 中文文档
- `README.md` - 项目说明
- `app.json` - 应用配置
- `package.json` - 依赖配置

### 2. 编辑器配置
创建了以下配置文件确保编码一致性：

#### `.vscode/settings.json`
- 设置默认文件编码为 UTF-8
- 禁用自动猜测编码
- 统一行尾符为 LF

#### `.editorconfig`
- 跨编辑器的编码规范
- 确保所有文件使用 UTF-8
- 统一缩进和行尾符

#### `.gitattributes`
- Git 版本控制的文件处理规则
- 确保文本文件使用 LF 行尾符
- 正确处理二进制文件

### 3. 启动脚本优化
创建了 `start-with-utf8.bat`，自动设置 UTF-8 编码后启动开发服务器。

## 使用方法

### 方式 1：使用优化的启动脚本（推荐）
双击运行 `start-with-utf8.bat`

### 方式 2：手动设置编码
在 PowerShell 中执行：
```powershell
chcp 65001
cd rork--
bun run start
```

### 方式 3：使用 VSCode
1. 打开项目文件夹
2. VSCode 会自动应用 `.vscode/settings.json` 中的配置
3. 使用内置终端运行 `bun run start`

## 如何检查文件编码

### 在 VSCode 中
1. 打开文件
2. 查看右下角状态栏的编码显示
3. 应该显示 "UTF-8 with BOM" 或 "UTF-8"

### 在 PowerShell 中
```powershell
# 设置 UTF-8 编码
chcp 65001

# 查看文件内容
Get-Content -Path "locales\zh.ts" -Encoding UTF8 | Select-Object -First 10
```

## 预防未来的编码问题

### 1. 始终使用 UTF-8 编码
- 在编辑器中创建新文件时，确保使用 UTF-8 编码
- VSCode：右下角点击编码 → 选择 "Save with Encoding" → 选择 "UTF-8"

### 2. 使用正确的终端
- Windows Terminal（推荐）：自动支持 UTF-8
- PowerShell：运行 `chcp 65001` 设置 UTF-8
- CMD：运行 `chcp 65001` 设置 UTF-8

### 3. Git 配置
确保 Git 正确处理文件编码：
```bash
git config --global core.autocrlf false
git config --global core.eol lf
```

## 常见问题

### Q: 为什么选择 UTF-8 with BOM？
A: BOM（Byte Order Mark）可以帮助 Windows 系统正确识别 UTF-8 编码，避免乱码问题。

### Q: 如果新增文件出现乱码怎么办？
A: 运行 `fix-encoding.ps1` 脚本重新修复所有文件编码。

### Q: 在 Mac/Linux 上会有问题吗？
A: 不会。UTF-8 是跨平台的标准编码，Mac 和 Linux 原生支持。

## 相关文件

- `fix-encoding.ps1` - 编码修复脚本
- `start-with-utf8.bat` - UTF-8 模式启动脚本
- `.vscode/settings.json` - VSCode 编辑器配置
- `.editorconfig` - 跨编辑器配置
- `.gitattributes` - Git 文件处理规则

## 技术细节

### 编码转换过程
1. 尝试使用多种编码读取文件（UTF-8, GBK, GB2312）
2. 检测内容是否包含非法字符
3. 使用 UTF-8 with BOM 重新保存文件

### 为什么会出现乱码？
- Windows 默认使用 GBK/GB2312 编码（中文 Windows）
- 项目文件使用 UTF-8 编码
- 编码不匹配导致中文字符显示为乱码

### UTF-8 vs UTF-8 with BOM
- UTF-8：无 BOM 标记，更通用
- UTF-8 with BOM：有 BOM 标记（EF BB BF），Windows 更容易识别
- 本项目使用 UTF-8 with BOM 以确保 Windows 兼容性

## 总结

所有编码问题已修复，项目现在可以在 Windows、Mac 和 Linux 上正常显示中文。建议使用 `start-with-utf8.bat` 启动项目以获得最佳体验。




